## Task 1

```Wolfram
(*Generate RSA Keys*)
p = RandomPrime[{2^1535, 2^1536 - 1}];
q = RandomPrime[{2^1535, 2^1536 - 1}];
n = p*q;
While[BitLength[n] != 3072, p = RandomPrime[{2^1535, 2^1536 - 1}]; q = RandomPrime[{2^1535, 2^1536 - 1}]; n = p*q;]
phi = (p - 1)*(q - 1);
e = RandomPrime[{2^16, phi}];
While[GCD[e, phi] != 1, e = RandomPrime[{2^16, phi}]];
d = PowerMod[e, -1, phi];

(*Original message from Lab 2*)
originalMessage = "RIVERBANK PUBLICATION NO. 22, WRITTEN IN 1920 WHEN FRIEDMAN WAS 28, MUST BE REGARDED AS THE MOST IMPORTANT SINGLE PUBLICATION INCRYPTOLOGY. IT TOOK THE SCIENCE INTO A NEW WORLD. ENTITLED THE INDEX OF COINCIDENCE AND ITS APPLICATIONS IN CRYPTOGRAPHY, IT DESCRIBED THE SOLUTION OF TWO COMPLICATED CIPHER SYSTEMS.FRIEDMAN, HOWEVER, WAS LESS INTERESTED IN PROVING THEIR VULNERABILITY THAN HE WAS IN USING THEM AS VEHICLE FOR NEW METHODS OF CRYPTANALYSIS.IN IT, FRIEDMAN DEVISED TWO NEW TECHNIQUES. ONE WAS BRILLIANT. IT PERMITTED HIM TO RECONSTRUCT A PRIMARY CIPHER ALPHABET WITHOUT HAVING TO GUESS AT A SINGLE PLAINTEXT LETTER. BUTT THE OTHER WAS PROFOUND. FOR THE FIRST TIME IN CRYPTOLOGY, FRIEDMAN TREATED A FREQUENCY DISTRIBUTION AS ANENTITY, AS A CURVE WHOSE SEVERAL POINTS WERE CAUSALLY RELATED, NOT AS eUSTA COLLECTION OF INDIVIDUAL LETTERS THAT HAPPEN TO STAND IN A CERTAIN ORDER FOR NONCAUSAL (HISTORICAL) REASONS, AND TO THIS CURVE HE APPLIED STATISTICAL CONCEPTS. THE RESULTS CAN ONLY BE DESCRIBED AS PROMETHEAN, FORFRIEDMAN'S STROKE OF GENIUS INSPIRED THE NUMEROUS, VARIED, AND VITALSTATISTICAL TOOLS THAT ARE INDISPENSABLE TO THE CRYPTOLOGY OF TODAY.BEFORE FRIEDMAN, CRYPTOLOGY EKED OUT AN EXISTENCE AS A STUDY UNTOITSELF, AS AN ISOLATED PHENOMENON, NEITHER BORROWING FROM NOR CONTRIBUTING TO OTHER BODIES OF KNOWLEDGE. FREQUENCY COUNTS, LINGUISTIC CHARACTERISTICS, KASISKI EXAMINATIONS— ALL WERE PECULIAR AND PARTICULAR TOCRYPTOLOGY. IT DWELT A RECLOSE IN THE WORLD OF SCIENCE. FRIEDMAN LEDCRYPTOLOGY OUT OF THIS LONELY WILDERNESS AND INTO THE BROAD RICH DOMAIN OF STATISTICS. HE CONNECTED CRYPTOLOGY TO MATHEMATICS. THE SENSE OF EXPANDING HORIZONS MUST HAVE REMEMBLED THAT FELT BY CHEMISTS WHENFRIEDRICH WOHLER SYNTHESIZED UREA, DEMONSTRATING THAT LIFE PROCESSESOPERATE UNDER WELL KNOWN CHEMICAL LAWS AND ARE THEREFORE SUBJECT TO EXPERIMENTATION AND CONTROL, AND LEADING TO TODAYS VAST STRIDES INBIOCHEMISTRY. WHEN FRIEDMAN SUBSUMED CRYPTANALYSIS UNDER STATISTICS, HE LIKEWISE FLUNG WIDE THE DOOR TO ANARMAMENTARIUM TO WHICH CRYPTOLOGY HAD NEVER BEFORE HAD ACCESS. ITSWEAPONS—MEASURES OF CENTRAL TENDENCY AND DISPERSION, OF FIT ANDSKEWNESS, OF PROBABILITY AND SAMPLING AND SIGNIFICANCE— WERE IDEALLY FASHIONED TO DEAL WITH THE STATISTICAL BEHAVIOR OF LETTERS AND WORDS.CRYPTANALYSTS, SEIZING THEM WITH ALACRITY, HAVE WIELDED THEM WITHNOTABLE SUCCESS EVER SINCE.THIS IS WHY FRIEDMAN HAS SAID, IN LOOKING BACK OVER HIS CAREER, THAT THE INDEX OF COINCIDENCE WAS HIS GREATEST SINGLE CREATION. IT ALONE WOULD HAVE WON HIM HIS REPUTATION. BUT IN FACT IT WAS ONLY THE BEGINNING. HE AND MRS. FRIEDMAN QUIT RIVERBANK NEAR THE END OF 1920. THE SITUATION HAD BECOME INTOLERABLE. FABYAN HAD LURED HIM BACK AFTER THE WAR WITH RAISES AND PROMISES OF ABSOLUTE FREEDOM TO PROVE OR DISPROVE THE EXISTENCE OF CIPHERS IN SHAKESPEARE. BUT HE HAD SQUELCHED EVERY ATTEMPT TO DO SO AND HAD EMBARRASSED FRIEDMAN INTO
APPARENTLY ACQUIESCENT SILENCE AT LANTERN-SLIDE LECTURES ON THE SUBEECT. MR eANUARY 1, 1921, FRIEDMAN BEGAN A SIX-MONTH CONTRACT WITH THE SIGNAL CORPS ODEVISE CRYPTOSYSTEMS. WHEN IT EXPIRED, HE WAS TAKEN ON THE CIVIL-SERVICE PAYROLL OF THE WAR DEPARTMENT AT $4,500 A YEAR.ONE OF HIS FIRST ASSIGNMENTS WAS TO TEACH A COURSE IN MILITARY CODES AND CIPHERS AT THE SIGNAL SCHOOL, THEN AT CAMP ALFRED VAIL, NEW EERSEY.FOR THIS HE WROTE A TEXTBOOK THAT, FOR THE FIRST TIME, IMPOSED ORDER UPON THE CHAOS OF CIPHER SYSTEMS AND THEIR TERMINOLOGY. THESE HAD SPROUTEDIN A BEWILDERING VARIETY, AND WRITERS TREATED EACH AS INDIVIDUAL AND SPECIAL CASES. FRIEDMAN SORTED THEM OUT ON THE BASIS OF STRUCTURE INSTEAD OF ASPECT, AND SO LOGICAL AND USEFUL WAS THIS CLASSIFICATION THAT ITHAS BECOME
STANDARD. HE MODELED HIS NOMENCLATURE ON HIS CATEGORIES, SO THAT THE NAMES HE MINTED HAVE THE GREAT MERIT OF MAKING THE RELATIONS BETWEEN THE VARIOUS GENERA OF CIPHERS OBVIOUS ON SIGHT. AN EXAMPLE IS THECOMPLEMENTARY PAIR MONO ALPHABET AND POLYALPHABET; THE FRENCHWERE STILL CALLING POLYALPHABETIC SYSTEMS BY THE ALMOST OBFUSCATORY DOUBLE SUBSTITUTION,WHICH TELLS ABSOLUTELY NOTHING AT ALL ABOUT THE SYSTEM. FRIEDMANS MOST IMPORTANT COINAGE WAS THE WORD CRYPTANALYSIS, WHICH HE DEVISED IN 1920 TO CLEAR UP A CHRONIC SOURCE OF CONFUSION IN CRYPTOLOGY—THE AMBIGUITY OF THE VERB DECIPHER, THEN USEDTO MEAN BOTH AUTHORIZED AND UNAUTHORIZED REDUCTIONS OF A CRYPTOGRAM TO PLAINTEXT.HE TITLED HIS BOOK ELEMENTS OF CRYPTANALYSIS, AND THE TERM HAS SOPROSPERED THAT TODAY IT CIRCULATES IN GENERAL CONVERSATION AND PRINT";

(*Hashed Message using MD6-256*)
hashedMessage = "2b2bfc84a6bf9d3e20858eb117a114a598ccf5510330c2cc6d5bc9fa88402148";

(*Sign the Message*)
signature = IntegerString[PowerMod[FromDigits[hashedMessage, 16], d, n], 16];

(*Validate the Signature*)
validatedHash = IntegerString[PowerMod[FromDigits[signature, 16], e, n], 16];

Print["Original Message: ", originalMessage, "Provided Hash: ", hashedMessage, "Signature: ", signature, "Validated Hash: ", validatedHash, "Signature is valid: ", validatedHash == hashedMessage];
```

## Task 2

```Wolfarm
(*Initialize Parameters*)
p = 3231700607131100730015351347782516336248805713348907517458843413926980683413621000279205636264016468545855635793533081692882902308057347262527355474246124574102620252791657297286270630032526342821314576693141422365422094111134862999165747826803423055308634905063555771221918789033272956969612974385624174123623722519734640269185579776797682301462539793305801522685873076199753243647748555460715043896844940366130497697812854295958659597567051283852132784468522925504568272879113720098931873959143374175837826000278034973198552060607533234122603254684088120031105907484281003994966956119696956248629032338072839127039;
g = 2;
hashedMessage = FromDigits["61a5f4c120aa535b8bd686343785a331", 16];

(*Generate ElGamal Keys*)
privateKey = RandomInteger[{1, p - 2}];
publicKey = PowerMod[g, privateKey, p];

(*Sign the Message*)
k = RandomInteger[{1, p - 2}];
While[GCD[k, p - 1] != 1, k = RandomInteger[{1, p - 2}]];
r = PowerMod[g, k, p];
inverseK = PowerMod[k, -1, p - 1];
s = Mod[inverseK * (hashedMessage - privateKey * r), p - 1];

(*Validate the Signature*)
isValidSignature = Mod[PowerMod[publicKey, r, p] * PowerMod[r, s, p], p] == PowerMod[g, hashedMessage, p];

(*Output*)
Print["Private Key: ", privateKey, "Public Key: ", publicKey,
  "Hashed Message: ", hashedMessage, "Signature (r, s): ", {r, s},
  "Signature is valid: ", isValidSignature];
```

## Hashing

For MD6 hashing I used: https://wtools.io/generate-md6-online#google_vignette
